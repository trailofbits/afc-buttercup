{
  "swagger": "2.0",
  "info": {
    "title": "Example Competition API",
    "contact": {},
    "version": "0.3"
  },
  "paths": {
    "/v1/task/{task_id}/patch/": {
      "post": {
        "security": [
          {
            "BasicAuth": []
          }
        ],
        "description": "submit a patch for testing",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "tags": ["patch"],
        "summary": "Submit Patch",
        "parameters": [
          {
            "type": "string",
            "format": "uuid",
            "description": "Task ID",
            "name": "task_id",
            "in": "path",
            "required": true
          },
          {
            "description": "Payload",
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/types.PatchSubmission"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/types.PatchSubmissionResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "404": {
            "description": "Not Found",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          }
        }
      }
    },
    "/v1/task/{task_id}/patch/{patch_id}/": {
      "get": {
        "security": [
          {
            "BasicAuth": []
          }
        ],
        "description": "yield the status of patch testing",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "tags": ["patch"],
        "summary": "Patch Status",
        "parameters": [
          {
            "type": "string",
            "format": "uuid",
            "description": "Task ID",
            "name": "task_id",
            "in": "path",
            "required": true
          },
          {
            "type": "string",
            "format": "uuid",
            "description": "Patch ID",
            "name": "patch_id",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/types.PatchSubmissionResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "404": {
            "description": "Not Found",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          }
        }
      }
    },
    "/v1/task/{task_id}/sarif/{sarif_id}/": {
      "post": {
        "security": [
          {
            "BasicAuth": []
          }
        ],
        "description": "submit a sarif assessment",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "tags": ["sarif"],
        "summary": "Submit Sarif Assessment",
        "parameters": [
          {
            "type": "string",
            "format": "uuid",
            "description": "Task ID",
            "name": "task_id",
            "in": "path",
            "required": true
          },
          {
            "type": "string",
            "format": "uuid",
            "description": "SARIF ID",
            "name": "sarif_id",
            "in": "path",
            "required": true
          },
          {
            "description": "Submission body",
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/types.SarifAssessmentSubmission"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/types.SarifAssessmentResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "404": {
            "description": "Not Found",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          }
        }
      }
    },
    "/v1/task/{task_id}/vuln/": {
      "post": {
        "security": [
          {
            "BasicAuth": []
          }
        ],
        "description": "submit a vulnerability for testing",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "tags": ["vulnerability"],
        "summary": "Submit Vulnerability",
        "parameters": [
          {
            "type": "string",
            "format": "uuid",
            "description": "Task ID",
            "name": "task_id",
            "in": "path",
            "required": true
          },
          {
            "description": "Submission body",
            "name": "payload",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/types.VulnSubmission"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/types.VulnSubmissionResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "404": {
            "description": "Not Found",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          }
        }
      }
    },
    "/v1/task/{task_id}/vuln/{vuln_id}/": {
      "get": {
        "security": [
          {
            "BasicAuth": []
          }
        ],
        "description": "yield the status of vuln testing",
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "tags": ["vulnerability"],
        "summary": "Vulnerability Status",
        "parameters": [
          {
            "type": "string",
            "format": "uuid",
            "description": "Task ID",
            "name": "task_id",
            "in": "path",
            "required": true
          },
          {
            "type": "string",
            "format": "uuid",
            "description": "Vuln ID",
            "name": "vuln_id",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/types.VulnSubmissionResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "404": {
            "description": "Not Found",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/types.Error"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "types.Architecture": {
      "type": "string",
      "enum": ["x86_64"],
      "x-enum-varnames": ["ArchitectureX864"]
    },
    "types.Assessment": {
      "type": "string",
      "enum": ["correct", "incorrect"],
      "x-enum-varnames": ["AssessmentCorrect", "AssessmentIncorrect"]
    },
    "types.Error": {
      "type": "object",
      "required": ["message"],
      "properties": {
        "fields": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "message": {
          "type": "string"
        }
      }
    },
    "types.PatchSubmission": {
      "type": "object",
      "required": ["patch"],
      "properties": {
        "description": {
          "description": "Optional plain text reasoning for the assessment\n\n128KiB max size",
          "type": "string",
          "maxLength": 131072
        },
        "patch": {
          "description": "Base64 encoded patch in unified diff format\n\n100KiB max size before Base64 encoding",
          "type": "string",
          "format": "base64"
        },
        "sarif_id": {
          "description": "Optional ID of SARIF Broadcast this patch is associated with",
          "type": "string",
          "format": "uuid"
        },
        "vuln_id": {
          "description": "Optional ID of Vuln this patch is associated with",
          "type": "string",
          "format": "uuid"
        }
      }
    },
    "types.PatchSubmissionResponse": {
      "type": "object",
      "required": ["patch_id", "status"],
      "properties": {
        "patch_id": {
          "type": "string",
          "format": "uuid"
        },
        "status": {
          "$ref": "#/definitions/types.SubmissionStatus"
        }
      }
    },
    "types.SarifAssessmentResponse": {
      "type": "object",
      "required": ["status"],
      "properties": {
        "status": {
          "$ref": "#/definitions/types.SubmissionStatus"
        }
      }
    },
    "types.SarifAssessmentSubmission": {
      "type": "object",
      "required": ["assessment", "description"],
      "properties": {
        "assessment": {
          "$ref": "#/definitions/types.Assessment"
        },
        "description": {
          "description": "Plain text reasoning for the assessment\n\n128KiB max size",
          "type": "string",
          "maxLength": 131072
        }
      }
    },
    "types.SubmissionStatus": {
      "type": "string",
      "enum": ["accepted", "invalid", "passed", "failed", "deadline_exceeded"],
      "x-enum-comments": {
        "SubmissionStatusAccepted": "Successfully submitted",
        "SubmissionStatusDeadlineExceeded": "Task deadline exceeded. All submissions marked accepted before the deadline will be evaluated.",
        "SubmissionStatusFailed": "Submission failed testing",
        "SubmissionStatusPassed": "Successfully evaluated submission"
      },
      "x-enum-varnames": [
        "SubmissionStatusAccepted",
        "SubmissionStatusInvalid",
        "SubmissionStatusPassed",
        "SubmissionStatusFailed",
        "SubmissionStatusDeadlineExceeded"
      ]
    },
    "types.VulnSubmission": {
      "type": "object",
      "required": ["architecture", "data_file", "harness_name", "sanitizer"],
      "properties": {
        "architecture": {
          "$ref": "#/definitions/types.Architecture"
        },
        "data_file": {
          "description": "Base64 encoded vuln trigger\n\n2MiB max size before Base64 encoding",
          "type": "string",
          "format": "base64"
        },
        "harness_name": {
          "description": "Fuzz Tooling Harness Name that exercises this vuln\n\n4KiB max size",
          "type": "string",
          "maxLength": 4096
        },
        "sanitizer": {
          "description": "Fuzz Tooling Sanitizer that exercises this vuln\n\n4KiB max size",
          "type": "string",
          "maxLength": 4096
        },
        "sarif": {
          "description": "Optional SARIF Report compliant with the provided versioned SARIF schema",
          "type": "object"
        }
      }
    },
    "types.VulnSubmissionResponse": {
      "type": "object",
      "required": ["status", "vuln_id"],
      "properties": {
        "status": {
          "$ref": "#/definitions/types.SubmissionStatus"
        },
        "vuln_id": {
          "type": "string",
          "format": "uuid"
        }
      }
    }
  },
  "securityDefinitions": {
    "BasicAuth": {
      "type": "basic"
    }
  }
}
